## [ ] 18.3.1.1  anchor (Object Cell Anchor)
## [ ] 18.3.1.2  autoFilter (AutoFilter Settings)
## [ ] 18.3.1.3  brk (Break)
## [ ] 18.3.1.4  c (Cell)
## [ ] 18.3.1.5  cellSmartTag (Cell Smart Tag)
## [ ] 18.3.1.6  cellSmartTagPr (Smart Tag Properties)
## [ ] 18.3.1.7  cellSmartTags (Cell Smart Tags)
## [ ] 18.3.1.8  cellWatch (Cell Watch Item)
## [ ] 18.3.1.9  cellWatches (Cell Watch Items)
## [ ] 18.3.1.10 cfRule (Conditional Formatting Rule)
## [ ] 18.3.1.11 cfvo (Conditional Format Value Object)
## [ ] 18.3.1.12 chartsheet (Chart Sheet)
## [x] 18.3.1.13 col (Column Width & Formatting) -- xlsx_ct_cols
## [ ] 18.3.1.14 colBreaks (Vertical Page Breaks)
## [ ] 18.3.1.15 color (Data Bar Color)
## [ ] 18.3.1.16 colorScale (Color Scale)
## [x] 18.3.1.17 cols (Column Information) -- xlsx_ct_cols
## [ ] 18.3.1.18 conditionalFormatting (Conditional Formatting)
## [ ] 18.3.1.19 control (Embedded Control)
## [ ] 18.3.1.20 controlPr (Embedded Control Properties)
## [ ] 18.3.1.21 controls (Embedded Controls)
## [ ] 18.3.1.22 customPr (Custom Property)
## [ ] 18.3.1.23 customProperties (Custom Properties)
## [ ] 18.3.1.24 customSheetView (Custom Chart Sheet View)
## [ ] 18.3.1.25 customSheetView (Custom Sheet View)
## [ ] 18.3.1.26 customSheetViews (Custom Chart Sheet Views)
## [ ] 18.3.1.27 customSheetViews (Custom Sheet Views)
## [ ] 18.3.1.28 dataBar (Data Bar)
## [ ] 18.3.1.29 dataConsolidate (Data Consolidate)
## [ ] 18.3.1.30 dataRef (Data Consolidation Reference)
## [ ] 18.3.1.31 dataRefs (Data Consolidation References)
## [ ] 18.3.1.32 dataValidation (Data Validation)
## [ ] 18.3.1.33 dataValidations (Data Validations)
## [ ] 18.3.1.34 dialogsheet (Dialog Sheet)
## [ ] 18.3.1.35 dimension (Worksheet Dimensions)
## [ ] 18.3.1.36 drawing (Drawing)
## [ ] 18.3.1.37 drawingHF (Drawing Reference in Header Footer)
## [ ] 18.3.1.38 evenFooter (Even Page Footer)
## [ ] 18.3.1.39 evenHeader (Even Page Header)
## [ ] 18.3.1.40 f (Formula)
## [ ] 18.3.1.41 firstFooter (First Page Footer)
## [ ] 18.3.1.42 firstHeader (First Page Header)
## [ ] 18.3.1.43 formula (Formula)
## [ ] 18.3.1.44 formula1 (Formula 1)
## [ ] 18.3.1.45 formula2 (Formula 2)
## [ ] 18.3.1.46 headerFooter (Header Footer Settings)
## [ ] 18.3.1.47 hyperlink (Hyperlink)
## [ ] 18.3.1.48 hyperlinks (Hyperlinks)
## [ ] 18.3.1.49 iconSet (Icon Set)
## [ ] 18.3.1.50 ignoredError (Ignored Error)
## [ ] 18.3.1.51 ignoredErrors (Ignored Errors)
## [ ] 18.3.1.52 inputCells (Input Cells)
## [ ] 18.3.1.53 is (Rich Text Inline)
## [x] 18.3.1.54 mergeCell (Merged Cell) -- xlsx_ct_merge_cell
## [x] 18.3.1.55 mergeCells (Merge Cells) -- xlsx_read_merged
## [ ] 18.3.1.56 objectPr (Embedded Object Properties)
## [ ] 18.3.1.57 oddFooter (Odd Page Footer)
## [ ] 18.3.1.58 oddHeader (Odd Header)
## [ ] 18.3.1.59 oleObject (Embedded Object)
## [ ] 18.3.1.60 oleObjects (Embedded Objects)
## [ ] 18.3.1.61 outlinePr (Outline Properties)
## [ ] 18.3.1.62 pageMargins (Page Margins)
## [ ] 18.3.1.63 pageSetup (Page Setup Settings)
## [ ] 18.3.1.64 pageSetup (Chart Sheet Page Setup)
## [ ] 18.3.1.65 pageSetUpPr (Page Setup Properties)
## [ ] 18.3.1.66 pane (View Pane)
## [ ] 18.3.1.67 picture (Background Image)
## [ ] 18.3.1.68 pivotArea (Pivot Area)
## [ ] 18.3.1.69 pivotSelection (PivotTable Selection)
## [ ] 18.3.1.70 printOptions (Print Options)
## [ ] 18.3.1.71 protectedRange (Protected Range)
## [ ] 18.3.1.72 protectedRanges (Protected Ranges)
## [ ] 18.3.1.73 row (Row)
## [ ] 18.3.1.74 rowBreaks (Horizontal Page Breaks (Row))
## [ ] 18.3.1.75 scenario (Scenario)
## [ ] 18.3.1.76 scenarios (Scenarios)
## [ ] 18.3.1.77 securityDescriptor (Security Descriptor)
## [ ] 18.3.1.78 selection (Selection)
## [ ] 18.3.1.79 sheetCalcPr (Sheet Calculation Properties)
## [ ] 18.3.1.80 sheetData (Sheet Data)
## [ ] 18.3.1.81 sheetFormatPr (Sheet Format Properties)
## [ ] 18.3.1.82 sheetPr (Sheet Properties)
## [ ] 18.3.1.83 sheetPr (Chart Sheet Properties)
## [ ] 18.3.1.84 sheetProtection (Chart Sheet Protection)
## [ ] 18.3.1.85 sheetProtection (Sheet Protection Options)
## [-] 18.3.1.86 sheetView (Chart Sheet View)
## [-] 18.3.1.87 sheetView (Worksheet View)
## [-] 18.3.1.88 sheetViews (Sheet Views)
## [-] 18.3.1.89 sheetViews (Chart Sheet Views)
## [ ] 18.3.1.90 smartTags (Smart Tags)
## [ ] 18.3.1.91 sortCondition (Sort Condition)
## [ ] 18.3.1.92 sortState (Sort State)
## [ ] 18.3.1.93 tabColor (Sheet Tab Color)
## [ ] 18.3.1.94 tablePart (Table Part)
## [ ] 18.3.1.95 tableParts (Table Parts)
## [ ] 18.3.1.96 v (Cell Value)
## [ ] 18.3.1.97 webPublishItem (Web Publishing Item)
## [ ] 18.3.1.98 webPublishItems (Web Publishing Items)
## [ ] 18.3.1.99 worksheet (Worksheet)

## 18.3.1.17 cols
xlsx_ct_cols <- function(xml, ns) {
  process_container(xml, "d1:cols", ns, xlsx_ct_col)
}

## NOTE: width is a funny measurement that is a hybrid of pixels and
## character width:
##
## > Column width measured as the number of characters of the maximum
## > digit width of the numbers 0, 1, 2, ..., 9 as rendered in the
## > normal style's font. There are 4 pixels of margin padding (two on
## > each side), plus 1 pixel padding for the gridlines.
##
## But the actual calculation of how much space there is will vary
## with things like the border and padding thickness, boldness, etc.
xlsx_ct_col <- function(xml, ns) {
  at <- as.list(xml2::xml_attrs(xml))
  tibble::data_frame(
    best_fit = attr_bool(at$bestFit, FALSE),
    collapsed = attr_bool(at$collapsed, FALSE),
    custom_width = attr_bool(at$customWidth, FALSE),
    hidden = attr_bool(at$hidden, FALSE),
    min = attr_integer(at$min),
    max = attr_integer(at$max),
    outline_level = attr_integer(at$outlineLevel),
    phonetic = attr_bool(at$phonetic),
    style = attr_integer(at$style), # for new cols only
    width = attr_numeric(at$width))
}

## 18.3.1.55 mergeCells (Merge Cells)
xlsx_read_merged <- function(xml, ns) {
  merged <- xml2::xml_children(xml2::xml_find_one(xml, "d1:mergeCells", ns))
  lapply(merged, xlsx_ct_merge_cell)
}

## 18.3.1.54 mergeCell (Merged Cell)
xlsx_ct_merge_cell <- function(x) {
  cellranger::as.cell_limits(xml2::xml_attr(x, "ref"))
}
